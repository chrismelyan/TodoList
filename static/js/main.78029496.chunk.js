(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{123:function(t,e,a){t.exports=a(159)},128:function(t,e,a){},129:function(t,e,a){},159:function(t,e,a){"use strict";a.r(e);var n,o,i=a(0),r=a.n(i),c=a(31),l=a.n(c),s=(a(128),a(129),a(29)),u=a(41),d=a(104),f=a.n(d);!function(t){t[t.New=0]="New",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(n||(n={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Hi=2]="Hi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(o||(o={}));var m,p=f.a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"344e1d93-75ad-4579-8284-aae71a3ea37e"}}),g=function(){return p.get("todo-lists")},b=function(t){return p.post("todo-lists",{title:t})},E=function(t){return p.delete("todo-lists/".concat(t))},h=function(t,e){return p.put("todo-lists/".concat(t),{title:e})},v=function(t){return p.get("todo-lists/".concat(t,"/tasks"))},y=function(t,e){return p.post("todo-lists/".concat(t,"/tasks"),{title:e})},C=function(t,e,a){return p.put("/todo-lists/".concat(t,"/tasks/").concat(e),a)},k=function(t,e){return p.delete("/todo-lists/".concat(t,"/tasks/").concat(e))},I=function(t){return p.post("auth/login",t)},j=function(){return p.delete("auth/login")},O=function(){return p.get("/auth/me")},A=function(t,e){t(Z({error:e})),t(H({status:"failed"}))},w=function(t,e){t(Z(e.messages.length?{error:e.messages[0]}:{error:"some error"})),t(H({status:"failed"}))},T=a(33);!function(t){t[t.success=0]="success",t[t.error=1]="error",t[t.captcha=10]="captcha"}(m||(m={}));var D=Object(T.b)({name:"tasks",initialState:{},reducers:{removeTaskAC:function(t,e){var a=t[e.payload.todolistID],n=a.findIndex((function(t){return t.id===e.payload.taskID}));n>-1&&a.splice(n,1)},addTaskAC:function(t,e){t[e.payload.task.todoListId].unshift(e.payload.task)},changeTaskStatusAC:function(t,e){var a=t[e.payload.todolistID],n=a.findIndex((function(t){return t.id===e.payload.taskID}));n>-1&&(a[n].status=e.payload.status)},changeTaskTitleAC:function(t,e){var a=t[e.payload.todolistID],n=a.findIndex((function(t){return t.id===e.payload.taskID}));n>-1&&(a[n].title=e.payload.title)},setTasksAC:function(t,e){t[e.payload.todolistId]=e.payload.tasks}},extraReducers:function(t){t.addCase($,(function(t,e){t[e.payload.todolist.id]=[]})),t.addCase(_,(function(t,e){delete t[e.payload.todolistID]})),t.addCase(Y,(function(t,e){e.payload.todolists.forEach((function(e){return t[e.id]=[]}))})),t.addCase(et,(function(t,e){return{}}))}}),x=D.reducer,S=D.actions,L=S.removeTaskAC,z=S.addTaskAC,P=S.setTasksAC,F=S.changeTaskStatusAC,M=S.changeTaskTitleAC,N=Object(T.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedInAC:function(t,e){t.isLoggedIn=e.payload.value}}}),R=N.reducer,U=N.actions.setIsLoggedInAC,V=Object(T.b)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setStatusAC:function(t,e){t.status=e.payload.status},setErrorAC:function(t,e){t.error=e.payload.error},setIsInitializedAC:function(t,e){t.isInitialized=e.payload.initialized}}}),q=V.reducer,B=V.actions,H=B.setStatusAC,Z=B.setErrorAC,G=B.setIsInitializedAC,J=Object(T.b)({name:"todolists",initialState:[],reducers:{addTodolistAC:function(t,e){t.unshift(Object(u.a)(Object(u.a)({},e.payload.todolist),{},{filter:"all",entityStatus:"idle"}))},removeTodolistAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todolistID}));a>-1&&t.splice(a,1)},changeTodolistTitleAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todolistID}));t[a].title=e.payload.title},changeFilterAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todolistID}));t[a].filter=e.payload.value},setTodolistsAC:function(t,e){return e.payload.todolists.map((function(t){return Object(u.a)(Object(u.a)({},t),{},{filter:"all",entityStatus:"idle"})}))},changeTodolistEntityStatusAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todolistID}));t[a].entityStatus=e.payload.status},clearDataAC:function(t,e){return[]}}}),K=J.reducer,W=J.actions,$=W.addTodolistAC,_=W.removeTodolistAC,Y=W.setTodolistsAC,Q=W.changeTodolistEntityStatusAC,X=W.changeTodolistTitleAC,tt=W.changeFilterAC,et=W.clearDataAC,at=function(){return function(t){t(H({status:"loading"})),g().then((function(e){return t(Y({todolists:e.data})),t(H({status:"succeeded"})),e.data})).then((function(e){e.forEach((function(e){var a;t((a=e.id,function(t){t(H({status:"loading"})),v(a).then((function(e){t(P({tasks:e.data.items,todolistId:a})),t(H({status:"succeeded"}))})).catch((function(e){A(t,e.message)}))}))}))})).catch((function(e){A(t,e.message)}))}},nt=a(60),ot=a(19),it=Object(s.b)({todolists:K,tasks:x,app:q,auth:R}),rt=Object(T.a)({reducer:it,middleware:function(t){return t().prepend(nt.a)}}),ct=ot.c;window.store=rt;var lt=a(232),st=a(233),ut=a(234),dt=a(235),ft=a(227),mt=a(231),pt=a(224),gt=a(236),bt=a(237),Et=a(216),ht=a(221),vt=a(219),yt=i.forwardRef((function(t,e){return i.createElement(vt.a,Object.assign({elevation:6,ref:e,variant:"filled"},t))}));function Ct(){var t=ct((function(t){return t.app.error})),e=Object(ot.b)(),a=function(t,a){"clickaway"!==a&&e(Z({error:null}))};return i.createElement(ht.a,{open:null!==t,autoHideDuration:6e3,onClose:a},i.createElement(yt,{onClose:a,severity:"error",sx:{width:"100%"}},t))}var kt=a(14),It=a(225),jt=a(226),Ot=a(13),At=a(217),wt=a(213),Tt=r.a.memo((function(t){var e=t.callbackAddValue,a=t.entityStatus,n=Object(i.useState)(""),o=Object(Ot.a)(n,2),c=o[0],l=o[1],s=Object(i.useState)(null),u=Object(Ot.a)(s,2),d=u[0],f=u[1],m=function(){var t=c.trim();t?e(t):f("Title is required"),l("")};return r.a.createElement("div",null,r.a.createElement(At.a,{value:c,error:!!d,onChange:function(t){l(t.currentTarget.value),f(null)},onKeyPress:function(t){"Enter"===t.key&&m()},label:"Title",className:d?"error":"",helperText:d,disabled:"loading"===a}),r.a.createElement(ft.a,{color:"primary",onClick:m},r.a.createElement(wt.a,{fontSize:"large"})))})),Dt=r.a.memo((function(t){var e=Object(i.useState)(!1),a=Object(Ot.a)(e,2),n=a[0],o=a[1],c=Object(i.useState)(""),l=Object(Ot.a)(c,2),s=l[0],u=l[1];return n?r.a.createElement(At.a,{variant:"outlined",value:s,onChange:function(t){u(t.currentTarget.value)},autoFocus:!0,onBlur:function(){t.callbackUpdate(s),o(!1)},size:"small"}):r.a.createElement("span",{onDoubleClick:function(){o(!0),u(t.value)}},t.value)})),xt=a(108),St=a.n(xt),Lt=a(220),zt=function(t){var e=t.todolistID,a=t.id,o=t.status,c=t.title,l=t.entityStatus,s=Object(ot.b)(),d=function(t){var a,n;s((a=t,n=e,function(t){t(H({status:"loading"})),k(n,a).then((function(){t(L({taskID:a,todolistID:n})),t(H({status:"succeeded"}))})).catch((function(e){A(t,e.message)}))}))},f=Object(i.useCallback)((function(t,a){s(function(t,e,a){return function(n,o){var i=o().tasks[t].find((function(t){return t.id===e})),r=Object(u.a)(Object(u.a)({},i),{},{status:a});C(t,e,r).then((function(){n(F({todolistID:t,taskID:e,status:a}))})).catch((function(t){A(n,t.message)}))}}(e,t,a))}),[s,e]),m=Object(i.useCallback)((function(t,a){s(M({taskID:t,title:a,todolistID:e}))}),[s,e]);return r.a.createElement("div",null,r.a.createElement(Lt.a,{color:"primary",onChange:function(t){f(a,t.currentTarget.checked?n.Completed:n.New)},checked:o===n.Completed}),r.a.createElement(Dt,{entityStatus:l,value:c,callbackUpdate:function(t){m(a,t)}}),r.a.createElement(ft.a,{onClick:function(){return d(a)}},r.a.createElement(St.a,{color:"inherit"})))},Pt=a(223),Ft=a(214),Mt=function(t){var e=Object(ot.b)(),a=t.todolist.id,o=Object(ot.c)((function(t){return t.app.status})),c=Object(ot.c)((function(t){return t.tasks[a]}));"active"===t.todolist.filter&&(c=c.filter((function(t){return t.status===n.New}))),"completed"===t.todolist.filter&&(c=c.filter((function(t){return t.status===n.Completed})));var l=Object(i.useCallback)((function(t){e(function(t,e){return function(a){h(t,e).then((function(){a(X({todolistID:t,title:e}))})).catch((function(t){A(a,t.message)}))}}(a,t))}),[e,a]),s=Object(i.useCallback)((function(t){e(tt({todolistID:a,value:t}))}),[e,a]),u=Object(i.useCallback)((function(t){e(function(t,e){return function(a){a(H({status:"loading"})),y(t,e).then((function(t){t.data.resultCode===m.success?(a(z({task:t.data.data.item})),a(H({status:"succeeded"}))):w(a,t.data)})).catch((function(t){A(a,t.message)}))}}(a,t))}),[e,a]),d=Object(i.useCallback)((function(){var t;e((t=a,function(e){e(H({status:"loading"})),e(Q({todolistID:t,status:"loading"})),E(t).then((function(){e(_({todolistID:t})),e(H({status:"succeeded"}))})).catch((function(t){A(e,t.message)}))}))}),[e,a]);return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("h3",null,r.a.createElement(Dt,{value:t.todolist.title,callbackUpdate:l,entityStatus:o}),r.a.createElement(ft.a,{onClick:d,disabled:"loading"===o},r.a.createElement(Ft.a,null))),r.a.createElement(Tt,{callbackAddValue:u,entityStatus:o})),r.a.createElement(Pt.a,null,c.map((function(t){return r.a.createElement(zt,{key:t.id,todolistID:a,id:t.id,status:t.status,title:t.title,entityStatus:o})}))),r.a.createElement("div",null,r.a.createElement(pt.a,{variant:"all"===t.todolist.filter?"contained":"text",color:"secondary",onClick:function(){return s("all")}},"All"),r.a.createElement(pt.a,{variant:"active"===t.todolist.filter?"contained":"text",color:"primary",onClick:function(){return s("active")}},"Active"),r.a.createElement(pt.a,{variant:"completed"===t.todolist.filter?"contained":"text",color:"inherit",onClick:function(){return s("completed")}},"Completed")))},Nt=function(){var t=Object(ot.b)(),e=Object(ot.c)((function(t){return t.todolists})),a=ct((function(t){return t.auth.isLoggedIn})),n=Object(kt.g)();Object(i.useEffect)((function(){a?t(at()):n("/login")}),[n,t,a]);var o=Object(i.useCallback)((function(e){t(function(t){return function(e){e(H({status:"loading"})),b(t).then((function(t){t.data.resultCode===m.success?(e($({todolist:t.data.data.item})),e(H({status:"succeeded"}))):w(e,t.data)})).catch((function(t){A(e,t.message)}))}}(e))}),[t]);return r.a.createElement("div",null,r.a.createElement(It.a,{container:!0,style:{padding:"30px"}},r.a.createElement(jt.a,{style:{padding:"20px",background:"rgb(255,250,250, 0.9)"}},r.a.createElement(Tt,{callbackAddValue:o}))),r.a.createElement(It.a,{container:!0,spacing:3},e.map((function(t){return r.a.createElement(It.a,{key:t.id,item:!0},r.a.createElement(jt.a,{style:{padding:"15px",background:"rgb(255,250,250, 0.9)"},elevation:3},r.a.createElement(Mt,{todolist:t,key:t.id})))}))))},Rt=a(228),Ut=a(230),Vt=a(229),qt=a(211),Bt=a(111),Ht=function(){var t=Object(ot.b)(),e=ct((function(t){return t.auth.isLoggedIn})),a=Object(Bt.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){var e={};return t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(t.email)||(e.email="Invalid email address"):e.email="Required",t.password?t.password.length<3&&(e.password="Min password length 3"):e.password="Required",e},onSubmit:function(e){var n;t((n=e,function(t){t(H({status:"loading"})),I(n).then((function(e){e.data.resultCode===m.success?(t(U({value:!0})),t(H({status:"succeeded"}))):w(t,e.data)})).catch((function(e){A(t,e.message)}))})),a.resetForm()}});return e?r.a.createElement(kt.a,{to:"/"}):r.a.createElement(It.a,{container:!0,justifyContent:"center",style:{padding:"30px"}},r.a.createElement(It.a,{item:!0,justifyContent:"center"},r.a.createElement(jt.a,{style:{padding:"20px",background:"rgb(255,250,250, 0.9)"}},r.a.createElement("form",{onSubmit:a.handleSubmit},r.a.createElement(Rt.a,null,r.a.createElement(qt.a,null,r.a.createElement("p",null,"To log in get registered",r.a.createElement("a",{href:"https://social-network.samuraijs.com/",target:"_blank",rel:"noopener noreferrer"}," here")),r.a.createElement("p",null,"or use common test account credentials:"),r.a.createElement("p",null,"Email: free@samuraijs.com"),r.a.createElement("p",null,"Password: free")),r.a.createElement(Vt.a,null,r.a.createElement(At.a,Object.assign({label:"Email",margin:"normal"},a.getFieldProps("email"))),a.touched.email&&a.errors.email&&r.a.createElement("div",{style:{color:"red"}},a.errors.email),r.a.createElement(At.a,Object.assign({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),a.touched.password&&a.errors.password&&r.a.createElement("div",{style:{color:"red"}},a.errors.password),r.a.createElement(Ut.a,Object.assign({label:"Remember me",control:r.a.createElement(Lt.a,{checked:a.values.rememberMe})},a.getFieldProps("rememberMe"))),r.a.createElement(pt.a,{type:"submit",variant:"contained",color:"primary"},"Login")))))))};var Zt=function(){var t=ct((function(t){return t.app.status})),e=ct((function(t){return t.app.isInitialized})),a=ct((function(t){return t.auth.isLoggedIn})),n=Object(ot.b)();return Object(i.useEffect)((function(){n((function(t){t(H({status:"loading"})),O().then((function(e){e.data.resultCode===m.success?(t(U({value:!0})),t(H({status:"succeeded"}))):w(t,e.data)})).catch((function(e){A(t,e.message)})).finally((function(){t(G({initialized:!0}))}))}))}),[n]),e?r.a.createElement("div",{className:"App"},r.a.createElement(Ct,null),r.a.createElement(st.a,{sx:{flexGrow:1}},r.a.createElement(ut.a,{position:"static",color:"secondary"},r.a.createElement(dt.a,null,r.a.createElement(ft.a,{edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2}},r.a.createElement(Et.a,null)),r.a.createElement(mt.a,{variant:"h6",component:"div",sx:{flexGrow:1}},"TO DO LIST"),a&&r.a.createElement(pt.a,{color:"inherit",onClick:function(){n((function(t){t(H({status:"loading"})),j().then((function(e){e.data.resultCode===m.success?(t(U({value:!1})),t(H({status:"succeeded"})),t(et())):w(t,e.data)})).catch((function(e){A(t,e.message)}))}))}},"Log out")),"loading"===t&&r.a.createElement(gt.a,null))),r.a.createElement(bt.a,{fixed:!0},r.a.createElement(kt.d,null,r.a.createElement(kt.b,{path:"/",element:r.a.createElement(Nt,null)}),r.a.createElement(kt.b,{path:"login",element:r.a.createElement(Ht,null)}),r.a.createElement(kt.b,{path:"404",element:r.a.createElement("h1",{style:{textAlign:"center",color:"white"}},"404 page not found")}),r.a.createElement(kt.b,{path:"*",element:r.a.createElement(kt.a,{to:"404"})})))):r.a.createElement("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"}},r.a.createElement(lt.a,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Gt=a(57);l.a.render(r.a.createElement(Gt.a,null,r.a.createElement(ot.a,{store:rt},r.a.createElement(Zt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[123,1,2]]]);
//# sourceMappingURL=main.78029496.chunk.js.map